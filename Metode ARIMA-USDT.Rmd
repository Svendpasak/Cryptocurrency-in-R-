---
title: "ARIMA-Tether(USDT)"
author: "Svend Pasak"
date: "5/4/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(tidyverse) 
library(lubridate) # date manipulation
library(forecast) # time series library
library(TTR) # for Simple moving average function
library(MLmetrics) # calculate error
library(tseries) # adf.test
library(fpp) # usconsumtion
library(TSstudio) # mempercantik visualisasi timeseries
library(padr)
library(zoo)
library(ggplot2)
```


```{r}
USDT <-  read.csv("D:\\data set USDT-USD.csv")
USDT
```

#Lihat Struktur Data
```{r}
str(USDT)
```

#Cek Missing Value
```{r}
anyNA(USDT)
```

#Menghilangkan Kolom yang tidak diperlukan dan mengubah tipe Data kolom "Date" dan "Close"
```{r}
USDT <- USDT %>%
  select(-c(Open,
            High,
            Low,
            Adj.Close,
            Volume)) %>% 
  mutate(Date=ymd(Date))
head(USDT)
```


```{r}
USDT <- na.omit(USDT)
```

#Exploratory data
```{r}
USDT %>% 
  ggplot(aes(Date, Close)) +
  geom_point() +
  geom_line() +
  labs(y = "USDT Closing Price") +
  theme_minimal()

plotly::ggplotly()
```
#Mengubah Data menjadi Data Time Series (ts)
#Untuk membuat sebuah object time series pada R kita bisa menggunakan function `ts()` dengan parameter yang diperlukan yaitu :"ts(data, start, frequency)"

* `data`  = data yang akan diprediksi
* `start` = waktu awal mula data yang akan diprediksi
* `frequency` = pola berulang dari data (pola harian)
```{r}
USDT_ts <- ts(data.frame(USDT$Close), 
  start = c(2017,03), end = c(2021,06),
  frequency = 30*12)
```


```{r}
USDT_ts %>% 
  autoplot() +
  geom_point() +
  labs(y = "USDT Closing Price ") +
  theme_minimal()
plotly::ggplotly()
```

#Decompose
```{r}
USDT_dc <- USDT_ts %>% 
  decompose(type = "multiplicative") %>% 
  autoplot()
USDT_dc
```

#adf Test
```{r}
adf.test(USDT_ts)
```

#Kesimpulan:
p-value < 0.05 sehingga Data sudah stationer tanpa melakukan differencing

```{r}
USDT_ts %>% 
  autoplot()
```
#Fitting model (using Auto Arima)
```{r}
USDT_auto <- auto.arima(USDT_ts, seasonal = FALSE, allowdrift = FALSE)
USDT_auto
summary(USDT_auto)
```


```{r}
tsdisplay(USDT_ts)
```
#Menggunakan ARIMA MAnual
```{r}
USDT_arima1 <- Arima(USDT_ts, order = c(0,0,0))
USDT_arima2 <- Arima(USDT_ts, order = c(1,0,0))
USDT_arima3 <- Arima(USDT_ts, order = c(0,0,1))
USDT_arima4 <- Arima(USDT_ts, order = c(1,0,1))
USDT_arima5 <- Arima(USDT_ts, order = c(2,0,0))
USDT_arima6 <- Arima(USDT_ts, order = c(2,0,1))
USDT_arima7 <- Arima(USDT_ts, order = c(2,0,2))
USDT_arima8 <- Arima(USDT_ts, order = c(3,0,0))
USDT_arima9 <- Arima(USDT_ts, order = c(3,0,1))
USDT_arima10 <- Arima(USDT_ts, order = c(3,0,2))
USDT_arima11 <- Arima(USDT_ts, order = c(3,0,3))
USDT_arima12 <- Arima(USDT_ts, order = c(3,0,4))
```

#Nilai AIC
```{r}
USDT_arima1$aic
USDT_arima2$aic
USDT_arima3$aic
USDT_arima4$aic
USDT_arima5$aic
USDT_arima6$aic
USDT_arima7$aic
USDT_arima8$aic
USDT_arima9$aic
USDT_arima10$aic
USDT_arima11$aic
USDT_arima12$aic
```

#Nilai Akurasi MAPE
```{r}
accuracy(USDT_arima1)
accuracy(USDT_arima2)
accuracy(USDT_arima3)
accuracy(USDT_arima4)
accuracy(USDT_arima5)
accuracy(USDT_arima6)
accuracy(USDT_arima7)
accuracy(USDT_arima8)
accuracy(USDT_arima9)
accuracy(USDT_arima10)
accuracy(USDT_arima11)
accuracy(USDT_arima12)
```

#Forecasting 30 hari
```{r}
forecast_30 <-  forecast(USDT_arima10, h=30)
forecast_30
```

```{r}
autoplot(forecast_30)+
  labs(y = "USDT Closing Price ") +
  theme_minimal()
plotly::ggplotly()
```














